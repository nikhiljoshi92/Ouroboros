digraph Xerox {

    node
        [shape=Mrecord width=1.5];

    subgraph cluster_XeroxFSM {

        label="XeroxFSM";

        //
        // States (Nodes)
        //

        "XeroxFSM::Initial"
            [label="{Initial}"];

        "XeroxFSM::WriteChannelCount"
            [label="{WriteChannelCount}"];

        "XeroxFSM::Suspended"
            [label="{Suspended}"];

        "XeroxFSM::WriteChannelHeader"
            [label="{WriteChannelHeader}"];

        "XeroxFSM::WriteSegmentHeader"
            [label="{WriteSegmentHeader}"];

        "XeroxFSM::CopySegment"
            [label="{CopySegment}"];

        "XeroxFSM::Finished"
            [label="{Finished}"];

        "XeroxFSM::Error"
            [label="{Error}"];

        "XeroxFSM::Closed"
            [label="{Closed}"];

        "%start"
            [label="" shape=circle style=filled fillcolor=black width=0.25];

        //
        // Transitions (Edges)
        //

        "XeroxFSM::Initial" -> "XeroxFSM::WriteChannelCount"
            [label="connect/\l"];

        "XeroxFSM::WriteChannelCount" -> "XeroxFSM::WriteChannelHeader"
            [label="finished/\l"];

        "XeroxFSM::WriteChannelCount" -> "XeroxFSM::Error"
            [label="writeReady/\l"];

        "XeroxFSM::WriteChannelCount" -> "XeroxFSM::Suspended"
            [label="writeReady/\l"];

        "XeroxFSM::Suspended" -> "XeroxFSM::WriteChannelHeader"
            [label="writeReady/\l"];

        "XeroxFSM::WriteChannelHeader" -> "XeroxFSM::WriteSegmentHeader"
            [label="finished/\l"];

        "XeroxFSM::WriteChannelHeader" -> "XeroxFSM::Error"
            [label="writeReady/\l"];

        "XeroxFSM::WriteChannelHeader" -> "XeroxFSM::WriteSegmentHeader"
            [label="writeReady/\l"];

        "XeroxFSM::WriteChannelHeader" -> "XeroxFSM::Finished"
            [label="channelsEmpty/\l"];

        "XeroxFSM::WriteSegmentHeader" -> "XeroxFSM::Error"
            [label="writeReady/\l"];

        "XeroxFSM::WriteSegmentHeader" -> "XeroxFSM::CopySegment"
            [label="writeReady/\l"];

        "XeroxFSM::WriteSegmentHeader" -> "XeroxFSM::CopySegment"
            [label="initiateCopy/\l"];

        "XeroxFSM::WriteSegmentHeader" -> "XeroxFSM::WriteChannelHeader"
            [label="finished/\l"];

        "XeroxFSM::CopySegment" -> "XeroxFSM::WriteSegmentHeader"
            [label="finished/\l"];

        "XeroxFSM::CopySegment" -> "XeroxFSM::Error"
            [label="writeReady/\l"];

        "XeroxFSM::CopySegment" -> "XeroxFSM::WriteSegmentHeader"
            [label="writeReady/\l"];

        "XeroxFSM::Finished" -> "XeroxFSM::Closed"
            [label="finished/\l"];

        "XeroxFSM::Finished" -> "XeroxFSM::Error"
            [label="readReady/\l"];

        "XeroxFSM::Finished" -> "XeroxFSM::Closed"
            [label="readReady/\l"];

        "%start" -> "XeroxFSM::Initial"
    }

}
